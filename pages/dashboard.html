<div class="dashboard">
    <div class="main-content">
        <div class="sidebar-left">
            <div class="card">
                <h3><i class="fas fa-sitemap"></i> 系统导航</h3>
                <ul class="component-list">
                    <li data-url="/cpp"><i class="fas fa-book"></i> C++ 知识点</li>
                    <li data-url="/algorithms"><i class="fas fa-cogs"></i> 算法库</li>
                    <li data-url="/editor"><i class="fas fa-code"></i> 代码编辑器</li>
                    <li data-url="/analysis"><i class="fas fa-chart-line"></i> 学习分析</li>
                </ul>
            </div>

            <div class="card">
                <h3><i class="fas fa-book"></i> C++ 知识点</h3>
                <div class="cpp-chapter-list">
                    <div class="chapter-item" data-chapter="1">第 1 章 预备知识</div>
                    <div class="chapter-item" data-chapter="2">第 2 章 开始学习 C++</div>
                    <div class="chapter-item" data-chapter="3">第 3 章 处理数据</div>
                    <!-- 更多章节... -->
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-cogs"></i> 算法库</h3>
                <div class="algorithm-grid">
                    <div class="algorithm-item" data-algo="DFS">DFS</div>
                    <div class="algorithm-item" data-algo="BFS">BFS</div>
                    <div class="algorithm-item" data-algo="DP">动态规划</div>
                    <!-- 更多算法... -->
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-chart-line"></i> 学习进度</h3>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="overall-progress" style="width: 30%;"></div>
                    </div>
                    <div class="progress-text">总体进度: 30%</div>
                    <!-- 更多进度条... -->
                </div>
            </div>
        </div>

        <div class="visualization-area">
            <h2>系统流程图</h2>
            <div id="cy"></div>

            <div class="tab-container">
                <div class="tabs">
                    <div class="tab active" data-tab="guide">使用指南</div>
                    <div class="tab" data-tab="mindmap">思维导图</div>
                    <div class="tab" data-tab="ai-solver">AI解题</div>
                </div>

                <div class="tab-content active" id="guide-content">
                    <div class="guide-content">
                        <div class="guide-section">
                            <h4>系统概述</h4>
                            <p>ACES系统是一个信息学竞赛万能引擎，包含输入层、ACES核心引擎、算法库和输出验证四个主要部分。</p>
                        </div>
                        <!-- 更多指南内容... -->
                    </div>
                </div>

                <div class="tab-content" id="mindmap-content">
                    <div id="mindmap-container">
                        <p>思维导图可视化区域</p>
                    </div>
                </div>

                <div class="tab-content" id="ai-solver-content">
                    <h4>AI解题助手</h4>
                    <div class="form-group">
                        <label for="problem-input">输入问题描述:</label>
                        <textarea id="problem-input" placeholder="描述您要解决的问题..."></textarea>
                        <button id="solve-problem" class="debug-btn">使用ACES解题</button>
                    </div>
                    <div id="ai-solution">
                        <h4>ACES解题步骤:</h4>
                        <div id="solution-steps" class="code-block"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar-right">
            <div class="card">
                <h3><i class="fas fa-info-circle"></i> 组件信息</h3>
                <div id="component-info">
                    <p>点击左侧组件或流程图节点查看详细信息</p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-book"></i> C++ 知识点内容</h3>
                <div id="chapter-content" class="chapter-content">
                    <p>点击左侧章节查看详细内容</p>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-book"></i> 规则库</h3>
                <div class="rule-content">
                    <h4>C系列 - 核心组件</h4>
                    <ul>
                        <li>C1. 算法可行性评估：任何算法必须在有限时间和空间内终止。</li>
                        <!-- 更多规则... -->
                    </ul>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-chart-bar"></i> 算法性能</h3>
                <div id="performance-chart">
                    <!-- 性能图表 -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 修改 dashboard.html 中的脚本部分 -->
<script>
// 仪表板特定的初始化代码
document.addEventListener('DOMContentLoaded', async () => {
    console.log('Dashboard 初始化');

    // 设置事件监听器
    setupDashboardEvents();

    // 初始化标签页
    switchTab('guide');
});

function setupDashboardEvents() {
    // 导航链接
    document.querySelectorAll('.component-list li').forEach(item => {
        item.addEventListener('click', () => {
            const url = item.getAttribute('data-url');
            console.log('导航到:', url);
            if (url && window.ACES_APP && window.ACES_APP.router) {
                window.ACES_APP.router.navigate(url);
            } else {
                // 后备导航
                window.location.hash = url;
                alert('功能开发中: ' + url);
            }
        });
    });

    // 章节点击事件
    document.querySelectorAll('.chapter-item').forEach(item => {
        item.addEventListener('click', () => {
            const chapter = item.getAttribute('data-chapter');
            showChapterContent(chapter);
        });
    });

    // 算法点击事件
    document.querySelectorAll('.algorithm-item').forEach(item => {
        item.addEventListener('click', () => {
            const algo = item.getAttribute('data-algo');
            showAlgorithmDetails(algo);
        });
    });

    // 标签页切换
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.getAttribute('data-tab');
            switchTab(tabId);
        });
    });

    // AI 解题按钮
    const solveBtn = document.getElementById('solve-problem');
    if (solveBtn) {
        solveBtn.addEventListener('click', solveWithAI);
    }
}

function switchTab(tabId) {
    // 隐藏所有标签内容
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });

    // 移除所有标签激活状态
    document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
    });

    // 显示选中的标签内容
    const targetContent = document.getElementById(`${tabId}-content`);
    const targetTab = document.querySelector(`.tab[data-tab="${tabId}"]`);

    if (targetContent) targetContent.classList.add('active');
    if (targetTab) targetTab.classList.add('active');
}

function showChapterContent(chapter) {
    const contentDiv = document.getElementById('chapter-content');
    if (contentDiv) {
        contentDiv.innerHTML = `
            <h4>第 ${chapter} 章内容</h4>
            <p>这里是第 ${chapter} 章的详细内容...</p>
            <div class="code-block">
                // 示例代码
                #include &lt;iostream&gt;
                using namespace std;

                int main() {
                    cout << "第 ${chapter} 章示例" << endl;
                    return 0;
                }
            </div>
        `;
    }
}

function showAlgorithmDetails(algo) {
    const infoDiv = document.getElementById('component-info');
    if (infoDiv) {
        const algoInfo = {
            'DFS': '深度优先搜索 - 用于遍历或搜索树或图的算法',
            'BFS': '广度优先搜索 - 层层扩展的搜索算法',
            'DP': '动态规划 - 通过把原问题分解为相对简单的子问题的方式求解复杂问题的方法'
        };

        infoDiv.innerHTML = `
            <h4>${algo} 算法</h4>
            <p>${algoInfo[algo] || '算法详细信息'}</p>
            <button class="debug-btn" onclick="ACES_APP.router.navigate('/algorithms')">学习更多</button>
        `;
    }
}

function solveWithAI() {
    const problemInput = document.getElementById('problem-input');
    const solutionDiv = document.getElementById('solution-steps');

    if (problemInput && solutionDiv) {
        const problem = problemInput.value.trim();
        if (!problem) {
            alert('请输入问题描述');
            return;
        }

        solutionDiv.innerHTML = `
            <p>🤖 ACES 正在分析问题...</p>
            <p>问题: ${problem}</p>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 70%"></div>
            </div>
            <p>解题步骤生成中...</p>
        `;

        // 模拟 AI 解题过程
        setTimeout(() => {
            solutionDiv.innerHTML = `
                <h5>ACES 解题方案:</h5>
                <ol>
                    <li>分析问题类型: 搜索/动态规划</li>
                    <li>选择合适的数据结构</li>
                    <li>设计算法流程</li>
                    <li>复杂度分析: O(n)</li>
                    <li>编写代码实现</li>
                </ol>
                <div class="code-block">
// ACES 生成的代码
#include &lt;iostream&gt;
using namespace std;

int main() {
    // 解决方案代码
    cout << "问题已解决!" << endl;
    return 0;
}
                </div>
            `;
        }, 2000);
    }
}
</script>